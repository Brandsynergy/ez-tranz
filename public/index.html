<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6366f1">
    <meta name="description" content="Simple mobile payment terminal">
    <title>EZ TRANZ - Mobile Payment Terminal</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div id="merchant-logo" style="display:none; margin-bottom:12px;">
                <img id="merchant-logo-img" src="" alt="" style="max-height:60px; max-width:200px; border-radius:8px;">
            </div>
            <h1 class="logo" id="terminal-logo">ðŸ’³ EZ TRANZ</h1>
            
            <!-- Merchant Business Details -->
            <div id="merchant-details" style="display:none; margin-top:12px; font-size:13px; opacity:0.95; line-height:1.6; text-align:center;">
                <div id="merchant-business-name" style="font-weight:600; font-size:16px; margin-bottom:6px; letter-spacing:0.3px;"></div>
                <div id="merchant-address" style="font-size:13px; margin-bottom:4px; opacity:0.9;"></div>
                <div id="merchant-phone" style="font-size:13px; font-weight:500; opacity:0.9;"></div>
            </div>
            
            <p class="tagline">SCAN .PAY .DONE</p>
            <div style="margin-top:10px; font-size:12px;">
                <a href="/merchant-login.html" style="color:#fff; text-decoration:underline;">Merchant Login</a>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Amount Input Screen -->
            <div id="amount-screen" class="screen active">
                <!-- Currency Selector -->
                <div class="currency-selector-container">
                    <label for="currency-select" class="currency-label">Currency:</label>
                    <select id="currency-select" class="currency-select">
                        <option value="usd" data-symbol="$" data-min="0.50">USD - US Dollar</option>
                        <option value="eur" data-symbol="â‚¬" data-min="0.50">EUR - Euro</option>
                        <option value="gbp" data-symbol="Â£" data-min="0.30">GBP - British Pound</option>
                        <option value="cad" data-symbol="$" data-min="0.50">CAD - Canadian Dollar</option>
                        <option value="aud" data-symbol="$" data-min="0.50">AUD - Australian Dollar</option>
                        <option value="jpy" data-symbol="Â¥" data-min="50">JPY - Japanese Yen</option>
                        <option value="chf" data-symbol="Fr" data-min="0.50">CHF - Swiss Franc</option>
                        <option value="cny" data-symbol="Â¥" data-min="3">CNY - Chinese Yuan</option>
                        <option value="inr" data-symbol="â‚¹" data-min="50">INR - Indian Rupee</option>
                        <option value="mxn" data-symbol="$" data-min="10">MXN - Mexican Peso</option>
                        <option value="brl" data-symbol="R$" data-min="2">BRL - Brazilian Real</option>
                        <option value="zar" data-symbol="R" data-min="8">ZAR - South African Rand</option>
                        <option value="ngn" data-symbol="â‚¦" data-min="500">NGN - Nigerian Naira</option>
                        <option value="kes" data-symbol="KSh" data-min="50">KES - Kenyan Shilling</option>
                        <option value="ghs" data-symbol="â‚µ" data-min="5">GHS - Ghanaian Cedi</option>
                    </select>
                    <p class="currency-hint" id="currency-hint">Minimum amount: $0.50</p>
                </div>

                <div class="amount-display">
                    <span class="currency" id="currency-symbol">$</span>
                    <input type="text" 
                           id="amount-input" 
                           class="amount-input" 
                           placeholder="0.00" 
                           inputmode="decimal"
                           autocomplete="off">
                </div>

                <div class="numpad">
                    <button class="num-btn" data-num="1">1</button>
                    <button class="num-btn" data-num="2">2</button>
                    <button class="num-btn" data-num="3">3</button>
                    <button class="num-btn" data-num="4">4</button>
                    <button class="num-btn" data-num="5">5</button>
                    <button class="num-btn" data-num="6">6</button>
                    <button class="num-btn" data-num="7">7</button>
                    <button class="num-btn" data-num="8">8</button>
                    <button class="num-btn" data-num="9">9</button>
                    <button class="num-btn" data-num=".">.</button>
                    <button class="num-btn" data-num="0">0</button>
                    <button class="num-btn clear-btn" data-action="clear">âŒ«</button>
                </div>

                <button id="charge-btn" class="charge-btn">Charge</button>
            </div>

            <!-- QR Code Screen -->
            <div id="qr-screen" class="screen">
                <div class="qr-header">
                    <h2>Customer Scans to Pay</h2>
                    <p class="qr-amount"><span id="qr-amount-text">$0.00</span></p>
                </div>
                <div class="qr-code-container">
                    <div id="qrcode"></div>
                </div>
                <p class="qr-instruction">Customer scans this QR code with their phone camera</p>
                <div class="waiting-animation">
                    <div class="spinner"></div>
                    <p>Waiting for payment...</p>
                </div>
                <button id="cancel-qr" class="cancel-btn">Cancel</button>
            </div>

            <!-- Success Screen -->
            <div id="success-screen" class="screen">
                <!-- Clean success animation -->
                <div class="success-animation">
                    <div class="checkmark">âœ“</div>
                </div>
                
                <!-- Main success message -->
                <h2 class="success-title">Payment Successful!</h2>
                <p class="success-amount"><span id="success-amount">$0.00</span></p>
                
                <!-- Transaction ID - subtle -->
                <p class="transaction-id">Transaction ID: <span id="transaction-id">---</span></p>
                
                <!-- Primary actions - clean buttons -->
                <div class="primary-actions">
                    <button id="download-receipt" class="primary-action-btn receipt-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        View Receipt
                    </button>
                    <button id="go-to-dashboard" class="primary-action-btn dashboard-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        Dashboard
                    </button>
                </div>
                
                <!-- Share section - collapsed by default -->
                <details class="share-details">
                    <summary class="share-summary">Share Receipt</summary>
                    <div class="share-buttons">
                        <button id="share-whatsapp" class="share-btn">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                            WhatsApp
                        </button>
                        <button id="share-email" class="share-btn">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                            Email
                        </button>
                    </div>
                </details>
                
                <!-- Secondary action - new transaction -->
                <button id="new-transaction" class="new-transaction-btn">New Transaction</button>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>Powered by Stripe</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" onerror="console.error('Failed to load QRCode library from CDN')"></script>
    <script>
        // Wait for QRCode library to load before loading app
        window.addEventListener('load', () => {
            if (typeof QRCode === 'undefined') {
                console.error('QRCode library failed to load');
                alert('QR Code library failed to load. Please check your internet connection and refresh.');
            }
        });
    </script>
    <script src="/app.js?v=4"></script>
</body>
</html>
